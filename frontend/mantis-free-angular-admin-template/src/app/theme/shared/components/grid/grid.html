<div class="app-grid">
  <!-- CONTROLES -->
  <div class="d-flex justify-content-between align-items-center mb-2">
    <!-- Filtro -->
    <div class="d-flex align-items-center">
      <label class="me-2 mb-0">Filtrar:</label>
      <input
        type="text"
        class="form-control w-auto"
        style="min-width:200px; max-height:30px;"
        [(ngModel)]="filtro"
        (input)="filtrar()"
        placeholder="Buscar..."
      />
    </div>

    <!-- Items por página -->
    <div class="d-flex align-items-center">
      <label class="me-2 mb-0">Mostrar:</label>
      <select
        class="form-select form-select-sm"
        (change)="cambiarItemsPorPagina($event)"
        [value]="itemsPorPagina">
        <option *ngFor="let opt of opcionesItems" [value]="opt">
          {{ opt }}
        </option>
      </select>
    </div>
  </div>

  <!-- TABLA -->
  <div class="table-responsive">
    <table class="table table-hover custom-grid">
      <thead>
        <tr>
          <th *ngFor="let col of columnas"
              (click)="ordenarPor(col.field)"
              class="sortable-th"
              [class.active]="columnaOrden() === col.field"
              [class.asc]="columnaOrden() === col.field && ordenAscendente()"
              [class.desc]="columnaOrden() === col.field && !ordenAscendente()">

            {{ col.header }}

            <!-- ICONOS ORDEN -->
            <span class="icons">
              <!-- Default ↑↓ -->
              <span class="icon default">
                <i class="fas fa-up-down"></i>
              </span>

              <!-- Asc -->
              <span class="icon asc">
                <i class="fa-solid fa-arrow-down-short-wide"></i>
              </span>

              <!-- Desc -->
              <span class="icon desc">
                <i class="fa-solid fa-arrow-down-wide-short"></i>
              </span>
            </span>

          </th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let fila of paginaDatos">
          <td *ngFor="let col of columnas">
            <ng-container *ngIf="templates[col.field]; else valorNormal">
              <ng-container
                *ngTemplateOutlet="templates[col.field]; context:{ $implicit: fila }">
              </ng-container>
            </ng-container>
            <ng-template #valorNormal>
              {{ fila[col.field] }}
            </ng-template>
          </td>
        </tr>

        <tr *ngIf="paginaDatos.length === 0">
          <td [attr.colspan]="columnas.length"
              class="text-center text-muted py-4">
            No existe información
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- FOOTER -->
  <div class="d-flex justify-content-between align-items-center mt-2 grid-footer">
    <!-- Paginación -->
    <nav *ngIf="totalPaginas > 1">
      <ul class="pagination">
        <li class="page-item" [class.disabled]="paginaActual === 1">
          <a class="page-link" href="javascript:" (click)="cambiarPagina(paginaActual - 1)">
            Anterior
          </a>
        </li>

        <li class="page-item"
            *ngFor="let p of paginas"
            [class.active]="p === paginaActual">
          <a class="page-link" href="javascript:" (click)="cambiarPagina(p)">
            {{ p }}
          </a>
        </li>

        <li class="page-item" [class.disabled]="paginaActual === totalPaginas">
          <a class="page-link" href="javascript:" (click)="cambiarPagina(paginaActual + 1)">
            Siguiente
          </a>
        </li>
      </ul>
    </nav>

    <!-- Total -->
    <div class="text-end total-right">
      Mostrando: {{ mostrandoDesde }} - {{ mostrandoHasta }}
      de {{ datosFiltrados.length }}
    </div>
  </div>
</div>
